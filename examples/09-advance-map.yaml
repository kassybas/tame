settings:
  shieldEnv: true

targets:

  CreateMap:
    run:
    - var $config:
        linux:
          arch: amd64
          os: linux
        mac:
          arch: amd64
          os: darwin
        listy:
        - one
        - two
    - return: $config
  
  Build:
    run:
    - var $all:
      - this
      - is 
      - a
      - foo
    - call CreateMap: {}
      $: $result
    - sh: env
      
  GetPlatformConfig:
    args: {$platform}
    run:
    - call CreateMap: {}
      $: $config
    - return: $config.$platform
  
  PrintVars:
    run:
    - call GetPlatformConfig: {$platform: "mac"}
      $: $macConfig
    - sh: env

