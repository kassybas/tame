
settings:
  init: "set -eu"

targets:

  # echo:
  #   args: {$msg: ~}
  #   body:
  #     - shell: echo my msg $msg
  #       out: $res
  #   return: $res

  # name:
  #   body:
  #     - call:
  #         echo: {$msg: barna}
  #       result: $echores
  #   return: "$echores"

  mapme:
    body:
      - var:
          $nullme: null
          $isit: true
          $floatme: 3.1415
          $num: 1
          $my:
            lovely: "is amazing"
            again: "somth"
            deeper:
              how: "deepisyour"
              listzz:
                - one: "is"
                  two: "loneliest"
                - 22
                - and:
                    it: "goes"
                    deeper: "too"
      - shell: echo $my_lovely
      - shell: echo $my_again
      - shell: echo $my_deeper_how


  setone:
    body:
      - var:
          $person.sign.last: "yolo"
  settwo:
    body:
      - var:
          $person:
            sign:
              last: "yolo"
  updone:
    body:
      - var:
          $person:
            sign:
              last: "yolo"
      - var:
          $person.sign.first: "ok"
      - shell: echo ${person_sign_first}
      - shell: echo ${person_sign_last}

  trunc:
    body:
      - var:
          $person:
            sign:
              last: "yolo"
      - var:
          $person.sign: "over"
      - shell: echo ${person_sign}


  argme:
    args:
      $hello:
        tourist: "messageworld"
        dubist: ~
    body:
      - shell: "echo adding ${hello_tourist}"
        out: $hello.dubist
        opts: [silent]
      - shell: "echo adding ${hello_tourist_dubist}"
        opts: [silent]
    return: "$hello"

  getme:
    body:
      - call:
          argme: {}
        result: $hey
      - shell: echo $hey_dubist

  listme:
    body:
    - var:
        $list:
          - hey
          - okay
          - but:
              my: love
    - shell: echo ${list_2_but_my}
    return: $list

  mapme2:
    body:
      - call:
          listme: ~
        result: $l
      - shell: echo ${l_2_but_my}


  test1:
    body:
      - var:
          $hello:
            na: "tourist"
            ja: "oook"
      - var:
          $hello.na: "new"
      - shell: echo ${hello_ja}

  test2:
    body:
      - var:
          $hello:
          - na: "tourist"
          - ja: "oook"
      - var:
          $hello[1]: "new"
      - shell: env | grep hello
      - shell: echo ${hello_1}


  yolo:
    body:
      - var:
          $myvar:
            name: john
            age: 12
            kids:
              - maria
              - santa
              - jo:
                  age: 12
      # - shell: echo $myvar_name
    return: $myvar.kids

  caller:
      body:
        - var:
            $ok:
              me: "okay"
        - call:
            yolo: ~
          result: $ok.result
        - shell: env | grep ok
        - shell: echo $ok_result_2_jo_age

  failme:
      body:
        - var:
            $hello:
              -
                  - asdf
                  - 2asdf
              - again: a234
        - var:
            $hello[1].again: followme
        - shell: env | grep hello

  nope:
    body:
    - var:
        $hello:
          hey:
            you:
              and: alrigh
    - var:
        $hello.hey: okay
    - shell:  env | grep hello
